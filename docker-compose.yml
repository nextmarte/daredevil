services:
  web:
    # Build local com glibc (recomendado para torch/whisper)
    build: .
    # Se preferir usar imagem UV do GHCR: comente build acima e descomente a linha abaixo
    # image: ${UV_IMAGE:-ghcr.io/astral-sh/uv:0.9.2-python3.14-alpine}
    container_name: daredevil_web
    ports:
      - "0.0.0.0:8511:8511"
    environment:
      - DEBUG=1
      - WHISPER_MODEL=medium
      - MAX_AUDIO_SIZE_MB=25
      - TEMP_AUDIO_DIR=/tmp/daredevil
      - ALLOWED_HOSTS=*,http://cid-uff.net:8511/
      - PYTHONUNBUFFERED=1
    volumes:
      - ./:/app
    working_dir: /app
    entrypoint: ["/app/docker-entrypoint.sh"]
    restart: unless-stopped
