services:
  web:
    # Build local com glibc (recomendado para torch/whisper)
    build: .
    # Se preferir usar imagem UV do GHCR: comente build acima e descomente a linha abaixo
    # image: ${UV_IMAGE:-ghcr.io/astral-sh/uv:0.9.2-python3.14-alpine}
    container_name: daredevil_web
    ports:
      - "8511:8000"
    environment:
      - DEBUG=1
      - WHISPER_MODEL=medium
      - MAX_AUDIO_SIZE_MB=100
      - TEMP_AUDIO_DIR=/tmp/daredevil
      - ALLOWED_HOSTS=*
      - PYTHONUNBUFFERED=1
      - PYTHONWARNINGS=ignore::SyntaxWarning
    volumes:
      - ./:/app
    working_dir: /app
    entrypoint: ["/app/docker-entrypoint.sh"]
    restart: unless-stopped
